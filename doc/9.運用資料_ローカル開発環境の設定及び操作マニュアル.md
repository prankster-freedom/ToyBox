# ローカル開発環境の設定及び操作マニュアル

このドキュメントでは、ToyBox プロジェクトをローカル環境でセットアップし、開発を行うための手順を説明します。

## 1. 前提条件

以下のソフトウェアがインストールされていることを確認してください。

- **Node.js**: v18 以降
- **npm**: Node.js に同梱されています
- **Git**: リポジトリのクローンに必要です
- **Google Cloud CLI (gcloud)**: Datastore エミュレータの使用に必要です (オプションですが推奨)

## 2. セットアップ手順

### 2.1. リポジトリのクローン

```bash
git clone <repository_url>
cd ToyBox
```

### 2.2. 依存パッケージのインストール

プロジェクトのルートディレクトリで以下のコマンドを実行します。

```bash
npm install
```

## 3. アプリケーションの実行

### 3.1. 開発モードでの起動

開発モードでは、`NODE_ENV` が `development` に設定され、認証がバイパスされます。また、ファイル変更時の自動再起動 (nodemon) が有効になります。

```bash
npm run dev
```

サーバーが起動すると、`http://localhost:3000` でアクセスできます。

### 3.2. テストの実行

(テストスクリプトが実装されている場合)

```bash
npm test
```

## 4. Datastore エミュレータの使用

ローカルで Cloud Datastore の動作を模倣するために、エミュレータを使用できます。

1.  別のターミナルを開き、エミュレータを起動します。
    ```bash
    gcloud beta emulators datastore start
    ```
2.  アプリケーションを実行するターミナルで、環境変数を設定します。

    ```bash
    # Windows (PowerShell)
    $env:DATASTORE_EMULATOR_HOST="localhost:8081"

    # Linux / macOS
    export DATASTORE_EMULATOR_HOST=localhost:8081
    ```

3.  アプリケーションを起動します。

## 5. デバッグ

VS Code を使用している場合、`.vscode/launch.json` (もしあれば) を利用してデバッガをアタッチできます。
または、`console.log` を使用してデバッグ出力を確認してください。開発モードでは、API レスポンスにデバッグ情報が含まれる場合があります。
